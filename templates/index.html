{% extends "base.html" %}

{% block content %}
<!-- Search Bar at Top -->
<div class="search-bar-top sticky-top bg-white py-4 shadow-sm">
    <div class="container">
        <form method="get" action="/search" class="d-flex align-items-center gap-3">
            <input type="text" class="form-control form-control-lg flex-grow-1" name="query" placeholder="Search by name, description, or tags..." value="{{ request.args.get('query', '') }}" style="border-radius: 2rem;">
            <button type="submit" class="btn btn-primary btn-lg px-4">Search</button>
        </form>
    </div>
</div>

<!-- Categories Section -->
<div class="categories-section py-3 bg-light">
    <div class="container">
        <div class="d-flex flex-wrap gap-3 justify-content-center">
            <a href="/search?category=all" class="btn btn-outline-secondary rounded-pill px-4 {% if request.args.get('category', 'all') == 'all' %}active{% endif %}">All</a>
            <a href="/search?category=tech" class="btn btn-outline-secondary rounded-pill px-4 {% if request.args.get('category') == 'tech' %}active{% endif %}">Tech</a>
            <a href="/search?category=creative" class="btn btn-outline-secondary rounded-pill px-4 {% if request.args.get('category') == 'creative' %}active{% endif %}">Creative</a>
            <a href="/search?category=business" class="btn btn-outline-secondary rounded-pill px-4 {% if request.args.get('category') == 'business' %}active{% endif %}">Business</a>
            <a href="/search?category=fitness" class="btn btn-outline-secondary rounded-pill px-4 {% if request.args.get('category') == 'fitness' %}active{% endif %}">Fitness</a>
            <a href="/search?category=lifestyle" class="btn btn-outline-secondary rounded-pill px-4 {% if request.args.get('category') == 'lifestyle' %}active{% endif %}">Lifestyle</a>
            <a href="/search?category=education" class="btn btn-outline-secondary rounded-pill px-4 {% if request.args.get('category') == 'education' %}active{% endif %}">Education</a>
            <a href="/search?category=finance" class="btn btn-outline-secondary rounded-pill px-4 {% if request.args.get('category') == 'finance' %}active{% endif %}">Finance</a>
        </div>
    </div>
</div>

<!-- Profiles Grid -->
<div class="profiles-section py-5">
    <div class="container">
        <div class="row g-4">
            {% for user in users %}
            <div class="col-12 col-md-6 col-lg-4">
                <div class="card profile-card shadow-sm h-100">
                    <div class="card-body text-center">
                        <img src="{{ user.profile_picture or url_for('static', filename='img/default-avatar.png') }}" alt="{{ user.full_name }}" class="rounded-circle mb-3" style="width: 80px; height: 80px; object-fit: cover;">
                        <h5 class="fw-bold mb-1">{{ user.full_name or user.username }}</h5>
                        <p class="text-muted small mb-2">{{ user.profession or 'Creator' }}</p>
                        <div class="mb-2">
                            {% set tags = user.get_specialty_tags() %}
                            {% for tag in tags[:3] %}
                                <span class="badge bg-primary me-1">{{ tag }}</span>
                            {% endfor %}
                        </div>
                        <p class="small text-muted mb-2">{{ (user.bio or 'Amazing creator')[:60] }}{% if user.bio and user.bio|length > 60 %}...{% endif %}</p>
                        <a href="{{ url_for('profile', username=user.username) }}" class="btn btn-outline-primary btn-sm">View Profile</a>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="col-12">
                <div class="alert alert-info text-center">No profiles found. Try a different search or category.</div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
