{% extends "base_signed_in.html" %}

{% block title %}{{ user.full_name }} - Droply{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/profile.css') }}">
<style>
  /* Ensure profile page has consistent dark background */
  body, .main-content, .content-wrapper {
    background: #1f1f1f !important;
  }
  
  .profile-container {
    background: #1f1f1f !important;
  }
</style>
{% endblock %}

{% block content %}
<div class="profile-container">
  <!-- Mobile Header -->
  <div class="mobile-header">
    <div class="header-content">
      <a href="{{ url_for('discover') }}" class="nav-back">
        <i class="fas fa-arrow-left"></i>
      </a>
      <h1 class="page-title">
        <i class="fas fa-user"></i>
        {{ user.full_name }}
      </h1>
      <div class="header-actions">
        <button class="action-btn share-btn" title="Share Profile">
          <i class="fas fa-share-alt"></i>
        </button>
        <button class="action-btn favorite-btn" title="Save to Favorites">
          <i class="far fa-heart"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Profile Header -->
  <div class="profile-header">
    <div class="profile-image-container">
      <img src="{{ user.profile_picture or url_for('static', filename='img/default-avatar.svg') }}" 
           alt="{{ user.full_name }}" 
           class="profile-hero-image">
      {% if user.is_verified %}
      <div class="verified-badge">
        <i class="fas fa-check"></i>
      </div>
      {% endif %}
    </div>
    
    <h1 class="profile-hero-name">{{ user.full_name }}</h1>
    {% if user.profession %}
    <p class="profile-hero-title">{{ user.profession }}</p>
    {% endif %}
    {% if user.location %}
    <p class="profile-hero-location">
      <i class="fas fa-map-marker-alt"></i>
      {{ user.location }}
    </p>
    {% endif %}
    
    <!-- Social Media Icons -->
    <div class="profile-social-icons">
      <a href="{{ user.linkedin_url or '#' }}" target="_blank" class="social-icon">
        <i class="fab fa-linkedin"></i>
      </a>
      <a href="{{ user.twitter_url or '#' }}" target="_blank" class="social-icon">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="{{ user.github_url or '#' }}" target="_blank" class="social-icon">
        <i class="fab fa-github"></i>
      </a>
      <a href="{{ user.instagram_url or '#' }}" target="_blank" class="social-icon">
        <i class="fab fa-instagram"></i>
      </a>
      <a href="{{ user.website_url or '#' }}" target="_blank" class="social-icon">
        <i class="fas fa-globe"></i>
      </a>
      <a href="{{ user.youtube_url or '#' }}" target="_blank" class="social-icon">
        <i class="fab fa-youtube"></i>
      </a>
      <a href="{{ user.facebook_url or '#' }}" target="_blank" class="social-icon">
        <i class="fab fa-facebook"></i>
      </a>
      <a href="{{ user.snapchat_url or '#' }}" target="_blank" class="social-icon">
        <i class="fab fa-snapchat"></i>
      </a>
    </div>
  </div>

  <!-- Profile Content Grid -->
  <div class="profile-content">
    <!-- Left Column: About & Skills -->
    <div class="content-left">
      <!-- About Section -->
      {% if user.bio %}
      <div class="content-section">
        <h2 class="section-title">About Me</h2>
        <div class="bio-content">
          <p>{{ user.bio }}</p>
        </div>
      </div>
      {% endif %}

      <!-- Expertise Section -->
      {% if user.userise_1 or user.userise_2 or user.userise_3 %}
      <div class="content-section">
        <h2 class="section-title">Expertise & Skills</h2>
        <div class="userise-grid">
          {% if user.userise_1 %}
          <div class="skill-card">
            <i class="fas fa-star"></i>
            <span>{{ user.userise_1 }}</span>
          </div>
          {% endif %}
          {% if user.userise_2 %}
          <div class="skill-card">
            <i class="fas fa-star"></i>
            <span>{{ user.userise_2 }}</span>
          </div>
          {% endif %}
          {% if user.userise_3 %}
          <div class="skill-card">
            <i class="fas fa-star"></i>
            <span>{{ user.userise_3 }}</span>
          </div>
          {% endif %}
        </div>
      </div>
      {% endif %}

      <!-- Portfolio Section -->
      <div class="content-section">
        <h2 class="section-title">Portfolio</h2>
        <div class="portfolio-grid">
          <div class="portfolio-item">
            <div class="portfolio-placeholder">
              <i class="fas fa-image"></i>
              <span>Coming Soon</span>
            </div>
          </div>
          <div class="portfolio-item">
            <div class="portfolio-placeholder">
              <i class="fas fa-video"></i>
              <span>Video Content</span>
            </div>
          </div>
          <div class="portfolio-item">
            <div class="portfolio-placeholder">
              <i class="fas fa-file-alt"></i>
              <span>Case Studies</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column: Services & Booking -->
    <div class="content-right">
      <!-- Services Section -->
      <div class="services-section">
        <div class="services-header">
          <h2 class="services-title">Services & Pricing</h2>
        </div>
        
        <div class="service-item">
          <div class="service-header">
            <div class="service-icon">
              <i class="fas fa-video"></i>
            </div>
            <div class="service-info">
              <h3 class="service-title">1-on-1 Consultation</h3>
              <p class="service-desc">Personalized video call session</p>
            </div>
          </div>
          <div class="service-price">
            <span class="price-amount">${{ user.hourly_rate or 0 }}</span>
            <span class="price-unit">/session</span>
          </div>
        </div>

        {% if user.charity_percentage and user.charity_percentage > 0 %}
        <div class="service-item charity">
          <div class="service-header">
            <div class="service-icon">
              <i class="fas fa-heart"></i>
            </div>
            <div class="service-info">
              <h3 class="service-title">Charity Support</h3>
              <p class="service-desc">{{ user.charity_percentage }}% donated to charity</p>
            </div>
          </div>
        </div>
        {% endif %}

        <!-- Tip Jar -->
        <div class="tip-jar">
          <h3 class="tip-title">Support My Work</h3>
          <p class="tip-desc">Buy me a coffee to support my content creation</p>
          <div class="tip-amounts">
            <button class="tip-btn">$5</button>
            <button class="tip-btn">$10</button>
            <button class="tip-btn">$25</button>
            <button class="tip-btn custom">Custom</button>
          </div>
        </div>
      </div>

      <!-- Booking Section -->
      <div class="booking-section">
        <div class="booking-header">
          <h2 class="booking-title">Book a Session</h2>
          <div class="availability-status">
            <i class="fas fa-circle"></i>
            <span>Available Now</span>
          </div>
        </div>
        
        <a href="{{ url_for('user_booking_times', username=user.username) }}" 
           class="book-now-btn">
          <i class="fas fa-calendar-plus"></i>
          <span>Book Now - ${{ user.hourly_rate or 0 }}</span>
        </a>
        
        <div class="booking-footer">
          <p class="booking-note">
            <i class="fas fa-shield-alt"></i>
            Secure payment â€¢ Cancel anytime
          </p>
        </div>
      </div>

      <!-- Testimonials Section -->
      <div class="testimonials-section">
        <h2 class="testimonials-title">What People Say</h2>
        <div class="testimonial-item">
          <div class="testimonial-content">
            <p>"Amazing session! Really helped me understand the concepts I was struggling with."</p>
          </div>
          <div class="testimonial-author">
            <div class="author-avatar">JS</div>
            <div class="author-info">
              <span class="author-name">John Smith</span>
              <div class="testimonial-rating">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Favorite button functionality
  const favoriteBtn = document.querySelector('.favorite-btn');
  if (favoriteBtn) {
    favoriteBtn.addEventListener('click', function(e) {
      e.preventDefault();
      const icon = this.querySelector('i');
      
      // Toggle heart
      if (icon.classList.contains('fas')) {
        icon.classList.remove('fas');
        icon.classList.add('far');
        this.classList.remove('favorited');
      } else {
        icon.classList.remove('far');
        icon.classList.add('fas');
        this.classList.add('favorited');
      }
    });
  }

  // Share button functionality
  const shareBtn = document.querySelector('.share-btn');
  if (shareBtn) {
    shareBtn.addEventListener('click', function(e) {
      e.preventDefault();
      
      if (navigator.share) {
        navigator.share({
          title: document.title,
          url: window.location.href
        });
      } else {
        // Fallback: copy to clipboard
        navigator.clipboard.writeText(window.location.href).then(() => {
          // Show temporary feedback
          const originalIcon = this.querySelector('i');
          const originalClass = originalIcon.className;
          originalIcon.className = 'fas fa-check';
          this.style.background = '#10b981';
          this.style.color = 'white';
          
          setTimeout(() => {
            originalIcon.className = originalClass;
            this.style.background = '#3a3a3a';
            this.style.color = '#9ca3af';
          }, 2000);
        });
      }
    });
  }

  // Add loading animation to booking button
  const bookBtn = document.querySelector('.book-now-btn');
  if (bookBtn) {
    bookBtn.addEventListener('click', function() {
      this.style.opacity = '0.7';
      this.style.pointerEvents = 'none';
      
      // Add loading spinner
      const originalContent = this.innerHTML;
      this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> <span>Loading...</span>';
      
      // Reset after a short delay (in real implementation, this would be after the redirect)
      setTimeout(() => {
        this.style.opacity = '1';
        this.style.pointerEvents = 'auto';
        this.innerHTML = originalContent;
      }, 1000);
    });
  }
});
</script>
{% endblock %} 